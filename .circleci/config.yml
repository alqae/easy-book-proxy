version: 2.1

workflows:
  build-workflow:
    jobs:
      - runner

jobs:
  runner:
    resource_class: alqae/linode
    machine: true
    steps:
      - checkout
      - run:
          name: Show User Information
          command: |
            pwd  # Verifica el directorio actual
            ls -la  # Verifica los archivos del directorio actual
            whoami  # Verifica el usuario que est√° ejecutando el workflow
            id  # Verifica los grupos a los que pertenece el usuario, incluyendo docker
            cat $(pwd)/docker-compose.yml # Verifica el contenido del archivo
      - run:
          name: List Files in Working Directory
          command: |
            echo "Current Directory:"
            pwd
            echo "Files in Directory:"
            ls -l /var/lib/circleci-runner/workdir
      - run:
          name: Run Docker Compose Down
          command: |
            echo "Running docker compose down"
            docker compose -f $(pwd)/docker-compose.yml down
      - run:
          name: Run Docker Compose Up
          command: |
            echo "Running docker compose up"
            docker compose -f $(pwd)/docker-compose.yml up -d
      - run:
          name: Verify Docker Containers
          command: |
            echo "Listing Docker Containers"
            docker ps
